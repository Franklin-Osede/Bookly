<!-- Dashboard Principal - Bookly -->
<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>¡Bienvenido, {{ currentUser?.name || 'Usuario' }}!</h1>
      <p>Gestiona tu negocio de manera inteligente</p>
    </div>
    <div class="actions-section">
      <button mat-raised-button color="primary" (click)="refreshData()" [disabled]="isLoading">
        <mat-icon>refresh</mat-icon>
        Actualizar
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Cargando datos del dashboard...</p>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- Métricas Principales -->
    <div class="metrics-section">
      <mat-grid-list cols="4" rowHeight="120px" gutterSize="16px">
        <!-- Total Reservas -->
        <mat-grid-tile>
          <mat-card class="metric-card">
            <mat-card-content>
              <div class="metric-icon">
                <mat-icon>event</mat-icon>
              </div>
              <div class="metric-content">
                <h3>{{ metrics.totalReservations }}</h3>
                <p>Total Reservas</p>
              </div>
            </mat-card-content>
          </mat-card>
        </mat-grid-tile>

        <!-- Reservas Confirmadas -->
        <mat-grid-tile>
          <mat-card class="metric-card">
            <mat-card-content>
              <div class="metric-icon">
                <mat-icon>check_circle</mat-icon>
              </div>
              <div class="metric-content">
                <h3>{{ metrics.confirmedReservations }}</h3>
                <p>Confirmadas</p>
              </div>
            </mat-card-content>
          </mat-card>
        </mat-grid-tile>

        <!-- Reservas Pendientes -->
        <mat-grid-tile>
          <mat-card class="metric-card">
            <mat-card-content>
              <div class="metric-icon">
                <mat-icon>schedule</mat-icon>
              </div>
              <div class="metric-content">
                <h3>{{ metrics.pendingReservations }}</h3>
                <p>Pendientes</p>
              </div>
            </mat-card-content>
          </mat-card>
        </mat-grid-tile>

        <!-- Ingresos Totales -->
        <mat-grid-tile>
          <mat-card class="metric-card">
            <mat-card-content>
              <div class="metric-icon">
                <mat-icon>euro</mat-icon>
              </div>
              <div class="metric-content">
                <h3>{{ formatCurrency(metrics.totalRevenue) }}</h3>
                <p>Ingresos</p>
              </div>
            </mat-card-content>
          </mat-card>
        </mat-grid-tile>
      </mat-grid-list>
    </div>

    <!-- Contenido Principal -->
    <div class="main-content">
      <div class="content-grid">
        <!-- Reservas Recientes -->
        <div class="recent-reservations">
          <mat-card>
            <mat-card-header>
              <mat-card-title>
                <mat-icon>history</mat-icon>
                Reservas Recientes
              </mat-card-title>
              <mat-card-subtitle>Últimas 5 reservas</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div *ngIf="recentReservations.length === 0" class="no-data">
                <mat-icon>inbox</mat-icon>
                <p>No hay reservas recientes</p>
              </div>
              <mat-list *ngIf="recentReservations.length > 0">
                <mat-list-item *ngFor="let reservation of recentReservations" class="reservation-item">
                  <div class="reservation-info">
                    <div class="customer-info">
                      <h4>{{ reservation.customerName || 'Cliente' }}</h4>
                      <p>{{ reservation.startDate | date:'short' }}</p>
                    </div>
                    <div class="reservation-details">
                      <mat-chip [color]="getStatusColor(reservation.status)" selected>
                        {{ getStatusText(reservation.status) }}
                      </mat-chip>
                      <span class="amount">{{ formatCurrency(reservation.totalAmountAmount) }}</span>
                    </div>
                  </div>
                </mat-list-item>
              </mat-list>
            </mat-card-content>
            <mat-card-actions>
              <button mat-button color="primary" (click)="navigateToReservations()">
                Ver Todas las Reservas
                <mat-icon>arrow_forward</mat-icon>
              </button>
            </mat-card-actions>
          </mat-card>
        </div>

        <!-- Acciones Rápidas -->
        <div class="quick-actions">
          <mat-card>
            <mat-card-header>
              <mat-card-title>
                <mat-icon>flash_on</mat-icon>
                Acciones Rápidas
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div class="action-buttons">
                <button mat-raised-button color="primary" (click)="navigateToReservations()">
                  <mat-icon>event</mat-icon>
                  Gestionar Reservas
                </button>
                <button mat-raised-button color="accent" (click)="navigateToBusiness()">
                  <mat-icon>business</mat-icon>
                  Configurar Negocio
                </button>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>

      <!-- Estadísticas Adicionales -->
      <div class="stats-section">
        <mat-card>
          <mat-card-header>
            <mat-card-title>
              <mat-icon>analytics</mat-icon>
              Estadísticas del Negocio
            </mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="stats-grid">
              <div class="stat-item">
                <mat-icon>trending_up</mat-icon>
                <div class="stat-content">
                  <h4>{{ metrics.occupancyRate }}%</h4>
                  <p>Tasa de Ocupación</p>
                </div>
              </div>
              <div class="stat-item">
                <mat-icon>schedule</mat-icon>
                <div class="stat-content">
                  <h4>{{ metrics.pendingReservations }}</h4>
                  <p>Pendientes de Confirmar</p>
                </div>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>